<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>О плагине tar_clip</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
</head>
<body>
 <center>
  <h1>Расширитель буфера обмена</h1>
  <h2>Версия: 1.05</h2>
 </center>
 <h2>Автор: Python &lt;smisoft@rambler.ru&gt; (c) SmiSoft (SA)</h2>
 <h3>Что это такое:</h3>
 <p>В Windows существует особая функция: буфер обмена. В нем можно временно хранить
 любую информацию. Но буфер неудобен в силу ряда причин: в нем можно хранить только
 один кусок текста, некоторые программы не понимают формат буфера других программ.
 Есть целый ряд программ, решающих эти и другие проблемы. Особенно я хочу отметить
 <em>ClipMate</em> и <em>ClCl</em>. Именно эти две программы были взяты за идею создания этого
 плагина. Никаких сторонних библиотек при разработке не использовалось: это полностью
 мой код.
 <p>В отличии от других моих плагинов, где все функции были доступны как через
 визуальный интерфейс, так и через командную строку, ряд функций этого плагина
 доступны только через визуальный интерфейс. Не думаю, что это большой недостаток.
 <p>Плагин умеет:
 <ul>
  <li>Сохранять до 200 (можно уменьшать) последних использованных буферов обмена.
   К сожалению, в этой версии поддерживается только неформатированный текст, но
   это тоже, согласитесь, полезная возможность. В будущих версиях я постараюсь
   сделать поддержку форматированного текста и рисунков.
  <li>Умеет удалять форматирование из форматированного текста, в том числе и автоматически.
   Это полезно, если вы вставляете текст из HTML страницы в Word, а получаете
   абракадабру. Некоторые пользуются такой технологией: сперва вставляют полученный
   текст в Блокнот, затем повторно вырезают текс и вставляют в Word. Алиас ~puretext
   более удобная и красивая альтернатива.
  <li>Умеет производить перекодировку между раскладками (переводит <kbd>"ghbdtn"</kbd> в <kbd>"привет"</kbd>
  и <kbd>"цштвщцы"</kbd> в <kbd>"windows"</kbd>). Работает несколько хуже аналогов (<em>Punto Switcher</em> и 
  <em>Layout Fix</em>, взятые за основу), зато последние не умеют работать в <em>Delphi</em> (в них
  жестко "забиты" сочетания для вставки <em>Ctrl-V</em> и копирования <em>Ctrl-C</em>, тогда как в 
  <em>Delphi</em> при классической раскладке используются <em>Shift-Ins</em> для вставки и <em>Ctrl-Ins</em>
  для копирования). В плагине можно менять эти клавиши (хотя все известные мне
  программы их поддерживают) и даже задавать списки исключений (окна, где должны
  использоваться другие клавиши, возможность, взятая из <em>ClCl</em>). Также вы можете
  осуществлять коррекцию нажатого CapsLock (переводить из <kbd>"wINDOWS"</kbd> в <kbd>"Windows"</kbd> и
  наоборот, а также задавать собственные правила преобразования. 
  <li>Умеет производить транслитерацию, то есть переводить текст из <kbd>"шаре"</kbd> в <kbd>"share"</kbd>
  и наоборот. Поскольку таблица преобразований хранится в текстовом файл, вы легко
  можете задать свои правила преобразования.
  <li>Умеет вставлять текст не через буфер, а эмулируя печать на клавиатуре. Поскольку
  функция блокировки клавиатуры документирована лишь для Windows NT, клавиатура
  во время эмуляции не заблокирована - не нажимайте клавиши на клавиатуре и не 
  двигайте мышь во время симуляции. Это полезно, если хотите заполнить Web форму
  (например, <kbd>имя_пользователя{tab}пароль{переход на новую строку}</kbd> - для 
  автоматического входа). Разумеется, эту возможность можно использовать вместе с
  плагинами <em>tar_hotkey</em> и <em>tar_hotkeys</em>. Также, при таком режиме
  ввода полностью будет потеряно форматирование.
  <li>Дополнением к данной возможности является возможность ввода серийных номеров.
  При этом есть два режима: в первом режиме дефисы (<kbd>"-"</kbd>) заменяются на
  табуляции (для ввода в большинстве инсталляторов), либо на паузу (во втором случае,
  некоторые инсталляторы автоматически перекидывают пользователя дальше по номеру,
  когда закончилось предыдущее поле - пауза симулирует это). Теперь вам не нужно выделять
  серийник по кусочкам, достаточно выделить его целиком, включить нужный режим и 
  нажать <em>Shift-Ins</em> - серийник будет вставлен. Этот режим не нужен для программ,
  вводящих серийник единой строкой.
  <li>Вы можете включать любой из описанных ранее режимов однократно (команда <kbd>~paste</kbd>)
  или постоянно (через визуальный интерфейс).
 </ul>
 <h3>Как пользоваться:</h3>
 <p>Копируйте текст, как обычно. Кода вам потребуется использовать расширенные
 возможности, введите <kbd>~clipeditor</kbd>, в котором вы сможете выбрать ранее
 использованные клипы, или изменить настройки. Когда все закончите, переключитесь
 на нужное приложение и продолжите работу. Окно программы можно закрыть, если не 
 планируется дальнейшее использование, или оставить (в том числе и <em>"поверх всех
 окон"</em> - для удобства использования). Когда окно программы неактивно, оно никак
 не влияет на работу с буфером (кроме случая установленной галочки <em>"Авто ~pureclip"</em>).
 <p>Для смены кодовой страница неправильно набранного текста, убедитесь, что окно,
 в котором находится неправильно набранный текст не <em>"только для чтения"</em>, выделите текст и дайте
 TaR'у команду <kbd>~convert</kbd> (см. описание). По умолчанию, текст автоматически
 преобразуется к другой раскладке.
 <p>Для транислитерации, убедитесь, что окно, в котором находится текст для транслитерации
 не <em>"только для чтения"</em>. Выделите нужный текст и дайте TaR'у команду <kbd>
 ~translit</kbd>. По умолчанию, текст преобразуется.
 <p>Для постоянной смены режима вставки из буфера, дайте команду <kbd>~clipeditor</kbd>
 и выберите нужный режим из меню <kbd>"Клипы"</kbd>.
 <p>Для вставки с использованием указанного режима и/или клипа с известным номером,
 дайте команду <kbd>~paste /режим имя клипа</kbd>. <kbd>/режим</kbd> может быть 
 <kbd>/reg</kbd> для обычной вставки, <kbd>/key</kbd> для симуляции ввода с клавиатуры
 и <kbd>/s1</kbd> или <kbd>/s2</kbd> для ввода серийного номера. <kbd>Имя клипа</kbd>
 это имя, отображаемое в верхнем поле окна редактора клипов. Если имя клипа отсутствует,
 используется текущее содержимое буфера.
 <p>Менее часто используемые комбинации описаны в разделе <strong>Алиасы</strong>
 <h3>Алиасы:</h3>
 <ul>
  <li><kbd>~puretext</kbd>
  <br>Удаляет форматирование. Вам приходилось копировать с Web страниц какую либо
  информацию, а после вставки в Word получать абракадабру? Если да, то воспользуйтесь
  этой командой. Она сотрет все форматирование, но текст будет читабелен. Аналог
  утилиты PureText.
  <br>Если вы используете эту команду очень часто, присмотритесь к команде <kbd>
  Параметры\Авто ~pureclip</kbd> в Редакторе Клипов. Если опция включена, программа
  будет автоматически удалять форматирование из буфера каждый раз, когда туда попадет
  форматированный текст.
  <br>Если вы регулярно вставляете текст после применения <kbd>~pureclip</kbd>,
  присмотритесь к команде <kbd>Параметры\Вставлять по ~pureclip</kbd>. Если эта
  опция включена, команда <kbd>~pureclip</kbd> будет вставлять преобразованный
  текст в текущее окно, используя текущий режим.
  <li><kbd>~convert [/noauto][/norev] mode1 mode2</kbd>
  <br>Преобразовать кодировку.
  <br>Если указан ключ <kbd>/noauto</kbd>, то будет преобразована кодировка текущего
  буфера, иначе - выделенный текст, находящийся в текущем окне (при этом текст
  будет помещен в буфер).
  <br>Если указан ключ /norev, то преобразование будет проходить только в одну сторону.
  По умолчанию, текст <kbd>"Ghbdtn? Цштвщцы"</kbd> будет преобразован в <kbd>"Привет,
  Windows"</kbd>. Если указать <kbd>/norev</kbd>, то результат будет <kbd>"Ghbdtn,
  Windows"</kbd>.
  <br><kbd>Mode1</kbd> и <kbd>Mode2</kbd> - режимы преобразования. В .ini файле
  есть раздел <kbd>[convert]</kbd>, в котором указаны строки преобразования в виде
  <kbd>Mode=строка</kbd>. Алгоритм работы заключается в том, что символ первой строки
  заменяется на символ второй строки с тем же номером и наоборот (если не указан 
  <kbd>/norev</kbd>). Не найденные символы не изменяются. Вы можете создать
  свое преобразование, добавив в .ini файл новые строчки в этот раздел и указать
  вместо <kbd>Mode1</kbd> и <kbd>Mode2</kbd> соответствующие строки. Также вы
  можете изменить существующие преобразования.
  <li><kbd>~translit [/rev][/noauto]</kbd>
  <br>Осуществляет транслитерацию.
  <br>Если указан ключ <kbd>/rev</kbd>, то осуществляется транслитерация в обе
  стороны (то есть строчка <kbd>"Share фото"</kbd> станет <kbd>"Шаре foto"</kbd>,
  если режим не указан, то <kbd>"Шаре фото"</kbd>).
  <br>Если указан <kbd>/noauto</kbd>, то будет преобразован текущий буфер, иначе
  - выделенный текст, находящийся в текущем окне (при этом текст будет помещен в буфер).
  <br>Поскольку данные, используемые для обработки находятся в .ini файле в разделе
  <kbd>[translit]</kbd>, вы можете создавать свои правила и заменять существующие.
  Для этого измените или добавьте строчки этого раздела. Строчка имеет вид:
  <kbd>любая_уникальный_для_раздела_строка=начальный_символ[пробел]конечный_символ
  </kbd>, примеры смотрите в поставляемом файле.
  <li><kbd>~paste [/reg,/key,/s1,/s2] имя клипа</kbd>
  <br>Вставляет текст в текущее окно, используя указанный режим:
   <br><kbd>/reg</kbd> - обычная вставка (из буфера)
   <br><kbd>/key</kbd> - печать клипа, эмулируя клавиатуру
   <br><kbd>/s1</kbd> - то же, что и <kbd>/key</kbd>, но дефисы заменяются на табуляции (для ввода серийных номеров)
   <br><kbd>/s2</kbd> - то же, что и <kbd>/key</kbd>, но дефисы заменяются на длинные паузы (для ввода серийных номеров)
   <br>Указанный режим действует, даже если установлен другой глобальный режим.
   <br><kbd>имя клипа</kbd> - если не указано, то используется текущий клип, иначе
   - клип с указанным именем. Если клипа с указанным именем не найдено, ничего не
   происходит. Если вы регулярно используете какой-то клип, имеет смысл сделать его
   статическим - когда число динамических клипов превосходит указанное, то лишние
   клипы удаляются, статические не удаляются никогда (только вручную).
  <li><kbd>~clipeditor</kbd>
  <br>Показывает, или выводит на передний план окно визуального интерфейса (т.н. Редактор
  Клипов). Основные функции доступны через меню:
  <br><kbd>Параметры\Автоскрытие</kbd> - означает, ччто окно автоматически скроется,
  если не будет активно некоторое (задается) время. Идея взята из программы QNote.
  <br><kbd>Параметры\Всегда наверху</kbd> - означает, что окно не будет закрываться
  другими окнами - удобно, если нужно вставить несколько клипов в приложение, развернутое
  на весь экран (типа Word).
  <br><kbd>Параметры\Параметры буфера</kbd> - вызывает модальное окно, в котором вы
  можете сделать следующие изменения:
  <ul>
   <li>Время задержки - через какое время будет скрыто окно программы при установленной опции "Автоскрытие" (в миллисекундах)
   <li>Длина описания - сколько символов будет использоваться по умолчанию в качестве имени.
   <li>Количество клипов - максимальное число динамических клипов. Если число динамических клипов превосходит указанное, лишние клипы удаляются.
   <li>Ключ копирования - горячая клавиша, на которую повешена функция копирования. По умолчанию, Ctrl-Ins. В силу странного поведения компонента, он пишет Ctrl+Num0, но это правильно
   <li>Задержка копирования - сколько времени нужно дать программе для завершения функции копирования. Не рекомендую уменьшать это значение, если есть проблемы с автоматическим копированием в командах ~convert или ~translit, увеличьте это значение
   <li>Ключ вставки - горячая клавиша, на которую повешена функция вставки. По умолчанию, Shift-Insert. По этой клавише будет осуществляться симуляция печати с клавиатуры.
   <li>Задержка вставки - сколько времени дано приложению на завершение операции вставки. Не рекомендую уменьшать это значение. Если возникают проблемы с автоматической вставкой из команд ~convert, ~pureclip, ~translit - увеличьте это значение.
   <li>Задержка печати - сколько времени требуется приложению для реакции на клавишу. Не рекомендую уменьшать это значение. Если возникают проблемы с симуляцией печати - увеличьте это значение. Если вам посчастливилось работать на машине &lt;300MHZ, увеличьте значение минимум до 100.
   <li>Угу - сохранение изменений
   <li>Отмена - выход без сохранение
  </ul>
  <br><kbd>Параметры\Исключения</kbd> - вызывает модальное окно, в котором вы можете настроить список окон-исключений, в которых требуется использовать отличные горячие клавиши. Пока эта версия не поддерживает данную функциональность, поэтому эта функция отключена.
  <br>Вы можете выбирать имеющиеся клипы, используя выпадающий список. Вы можете
  редактировать имя клипа в верхнем поле. Вы можете изменять содержимое клипа в
  текстовом поле. Вы можете сделать клип статическим, установив галку в поле.
  Дело в том, что число динамических клипов (добавляющихся каждый раз, как в буфер
  попадет новое значение) ограничено (во избежание накопления мусора), число
  статических клипов больше и они не могут быть удалены автоматически.
 </ul>
 <h3>Особенности:</h3> 
 <p>Иногда не меняется кодировка при работе команды <kbd>~convert</kbd>
 <p>В некоторых программах странно работает функция эмуляции ввода с клавиатуры.

 <p><b><font size=+1 color=blue>История:</font></b>
 <br><font color=green>[+]</font>&nbsp;Новая фича
 <br><font color=blue>[*]</font>&nbsp;Пофиксен баг
 <br><font color=red>[-]</font>&nbsp;Убрана фича
 
 <p><font size=+1 color=blue>Версия 1.0a1 - 18.07.05</font>
 <br><font color=green>[+]</font>&nbsp;Первая рабочая версия плагина
 <br><font color=green>[+]</font>&nbsp;Алиас ~puretext
  
 <p><font size=+1 color=blue>Версия 1.0a - 24.07.05</font>
 <br><font color=green>[+]</font>&nbsp;Возможность сохранения истории буфера обмена через алиас ~clipeditor
 <br><font color=green>[+]</font>&nbsp;Более мощная версия ~pureclip
 <br><font color=green>[+]</font>&nbsp;Алиасы для смены раскладки клавиатуры и транслитерации ~convert и ~translit
 <br><font color=green>[+]</font>&nbsp;Вставка из указанного буфера по команде ~paste
 <br><font color=green>[+]</font>&nbsp;Новая документация

 <p><font size=+1 color=blue>Версия 1.01a - 27.07.05</font>
 <br><font color=blue>[*]</font>&nbsp;В некоторых программах плагин не захватывал содержимое буфера
 <br><font color=blue>[*]</font>&nbsp;Максимальный размер захватываемого неформатированного текста стал равен 64k
 <br><font color=blue>[*]</font>&nbsp;~pureclip теперь поддерживает Unicode, преобразуя его в обычный текст (понятный nonUnicode приложениям, чтобы в них не появлялись козябрики и знаки вопроса).

 <p><font size=+1 color=blue>Версия 1.05 - 15.03.06</font>
 <br><font color=blue>[*]</font>&nbsp;Пофиксен баг - программа некорректно захватывала буфер из полноценных Unicode приложений (в коллекции клипов оказывались на месте русских букв знаки вопроса :().
 
</body>
</html>
