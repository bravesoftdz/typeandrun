<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>Описание алиаса ~Txt2htm</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
</head>
<body>
 <center><a href="index_ru.html">Назад</a></center>
 <h3>~Txt2Htm</h3>
 <h4>Описание:</h4>
 Программа предназначена для преобразования формата таблиц. Я использовал ее для преобразования текстовых таблиц
 в таблицы гипертекста. Проблема возникла оттого, что Excel (осуществляющий данное преобразование) производит
 его крайне неэффективно, а мне был нужен эффективный код. Кроме того, с помощью данной программы можно решить
 проблему автоматической простановки ссылок (см. примерные файлы данных). Однако этим применения программы не
 заканчиваются, благодаря своей простоте она может конвертировать некоторые другие форматы.
 <h4>Работа с программой:</h4>
 <center><img src="txthtm_ru.gif"></center>
 Для преобразования необходимо написать скрипт преобразования. Это - текстовая строка, указывающая программе,
 как трактовать формат входного файла. Формат строки-скрипта:
 <br><i>id1id2id3...</i>
 <br>то есть сплошной (без пробелов и других разделителей) список идентификаторов и разделителей. Каждый
 элемент этого списка имеет следующий формат:
 <br><i>%модификатор и идентификатор без разделения%список разделителей через запятую</i>
 <br><i>Модификатор</i> - это последовательность символов:
 <ul>
  <li><i>число</i> - ширина поля. Если задана, то программа всегда будет читать из файла строку заданной длины.
  <li><i>*</i> - означает, что столбцы может разделять более одного разделителя. Лишние разделители игнорируются.
  <li><i>!</i> - означает, что данное поле не может быть пустым.
  <li><i>^</i> - означает, что все символы поля будут преобразованы к верхнему регистру.
  <li><i>_</i> - означает, что все символы поля будут преобразованы к нижнему регистру. Если возникает конфликт с предыдущим модификатором - действует последний.
  <li><i>&amp;</i> - означает, что лишние пробелы в начале и конце поля будут удалены
 </ul>
 <i>Идентификатор</i> начинается первым символом английского алфавита. В имени идентификатора могут встречаться только
 латинские буквы и цифры (символ '_' не разрешен!). Остальные символы игнорируются. Регистр значения не имеет.
 Имя идентификатора внутри шаблона (см. далее), заключенное в сиволы % заменяется на его значение.
 <br><i>Разделители</i> - символы, ограничивающие поле. Например, в текстовых таблицах, как правило, ограничителями
 являются символы псевдографики, или пробелы. Символы можно задавать в виде их кода (например, <i>#9</i> - код
 табуляции, <i>#13</i> - код новой строки), в виде сплошной строки (<i>'сплошная строка'</i>), либо в прямом виде.
 В прямой записи спецсимволы (запятая (,), бэкслеш (\), кавычка ('), решетка (#)) должны экранироваться символом
 бэкслеша (\). В сплошной строке такого делать не нужно. Следует выбирать наиболее оптимальный вид и придерживаться
 его в дальнейшем. Если после какого-то идентификатора нет разделителей, но он не имеет фиксированную длину, то
 считается, что его разделители совпадают с разделителями предыдущего. Поскольку большинство таблиц однородно,
 это свойство сильно упрощает запись скрипта. 
 <br><strong>Примеры:</strong>
 <i>%*&s1%#9,' '%12s2%%s3%\%,'\&'%*s4%#13#10</i>
 <br>Следуя данному скрипту, программа поймет, что после первого поля может стоять любое число разделителей пробелов
 и табуляций, причем лишние пробелы нужно удалить, второе поле имеет фиксированную ширину 12 байт (поэтому нет
 разделителей), третье поле заканчивается либо символом %, либо сочетанием \&, наконец, четвертое поле заканчивается
 одним или несколькими символами переноса строки в формате Windows (для Unix формат будет другим). Например, для
 последовательности
 <br><i>Раз[табуляция][пробел][табуляция]Два123456789Три\&Четыре[перенос строки][перенос строки]</i>
 <br>значения идентификаторов будут:
 <br><i>S1=Раз;S2=Два123456789;S3=Три;S4=Четыре</i>
 <br>Для таблицы с четырьмя столбцами и любыми разделителями оптимальный скрипт:
 <br><i>%*&s1%[разделитель, или список]%*&s2%%*&s3%</i> и т. д.
 <br>Если встречаются идентификаторы с одинаковыми именами, то последующие игнорируются.
 <br>Для работы нужно создать три шаблона: шаблон заголовка, базовый (данных) и суффикса (завершающий). Все три
 шаблона создаются в том формате, в каком должен быть выходной файл. Последовательность <i>%имя идентификатора%</i>
 будет заменена на значение идентификатора. Например, для предыдущего примера <i>%s3%</i> будет заменено на <i>Три</i>.
 Шаблон заголовка обрабатывается только один раз - он включается в начало файла, шаблон суффикса включается в конец,
 а шаблон данных включается последовательно для каждой записи (или строки) из входного файл. Максимальный размер
 поля - 2 килобайта. Кроме пользовательских идентификаторов, в программе есть шесть стандартных идентификаторов:
 <ul>
  <li><i>INNAME</i> - полное имя входного файла
  <li><i>OUTNAME</i> - имя генерируемого файла
  <li><i>PREFIX</i>, <i>DATA</i>, <i>SUFFIX</i> - имена файлов шаблонов заголовка, данных, суффикса
  <li><i>AUTHOR</i> - мое имя
 </ul>
 <h4>Пример шаблона заголовка</h4>
 &lt;HTML&gt;
 <br>&lt;HEAD&gt;&lt;TITLE&gt;Список %outname%&lt;/TITLE&gt;&lt;/HEAD&gt;
 <br>&lt;BODY&gt;
 <br>&lt;CENTER&gt;
 <br>&lt;H1&gt;Описание %inname%&lt;/H1&gt;
 <br>&lt;H2&gt;Этот файл %outname%&lt;/H2&gt;
 <br>&lt;br&gt;
 <br>&lt;TABLE BORDER=1&gt; 
  <br>&lt;strong&gt;
  <br>&lt;TR&gt;
   <br>&lt;TH WIDTH="20%"&gt;Файл&lt;/TH&gt;
   <br>&lt;TH WIDTH="70%"&gt;Описание&lt;/TH&gt;
   <br>&lt;TH WIDTH="10%"&gt;Открыть&lt;/TH&gt;
  <br>&lt;/TR&gt;
  <br>&lt;/strong&gt;
 <h4>Пример шаблона данных</h4> 
  &lt;TR&gt;
   <br>&lt;TH WIDTH="20%"&gt;&lt;font size="3" face="Arial"&gt;%S1%&lt;/font&gt;&lt;/TH&gt;
   <br>&lt;TH WIDTH="70%"&gt;&lt;font size="2" face="Arial"&gt;%S2%&lt;/font&gt;&lt;/TH&gt;
   <br>&lt;TH WIDTH="10%"&gt;&lt;font size="3" face="Arial"&gt;&lt;a href="%S1%"&gt;Открыть&lt;/a&gt;&lt;/font&gt;&lt;/TH&gt;
  <br>&lt;/TR&gt;
 <h4>Пример шаблона суффикса</h4>
  <br>&lt;/TABLE&gt;
 <br>&lt;br&gt;
 <br>&lt;hr width="75%"&gt;
 <br>&lt;br&gt;
 <br>&lt;table border=1&gt;
  <br>&lt;tr&gt;&lt;th width=400 colspan=2&gt;&lt;font size="-1"&gt;Сделано используя:&lt;/font&gt;&lt;/th&gt;&lt;/tr&gt;
  <br>&lt;tr&gt;&lt;th width=100&gt;&lt;font size="-2"&gt;Файл префикса:&lt;/font&gt;&lt;/th&gt;&lt;th width=300&gt;&lt;font size="-2"&gt;%prefix%&lt;/font&gt;&lt;/th&gt;&lt;/tr&gt;
  <br>&lt;tr&gt;&lt;th width=100&gt;&lt;font size="-2"&gt;Файл данных:&lt;/font&gt;&lt;/th&gt;&lt;th width=300&gt;&lt;font size="-2"&gt;%data%&lt;/font&gt;&lt;/th&gt;&lt;/tr&gt;
  <br>&lt;tr&gt;&lt;th width=100&gt;&lt;font size="-2"&gt;Файл суффикса:&lt;/font&gt;&lt;/th&gt;&lt;th width=300&gt;&lt;font size="-2"&gt;%suffix%&lt;/font&gt;&lt;/th&gt;&lt;/tr&gt;
  <br>&lt;tr&gt;&lt;th width=400 colspan=2&gt;&lt;font size="-1"&gt;Авторские права: %Author%&lt;/font&gt;&lt;/th&gt;&lt;/tr&gt;
 <br>&lt;/table&gt;
 <br>&lt;/CENTER&gt;
 <br>&lt;body&gt;
 <br>&lt;/html&gt;
 <h4>Скрипт преобразования:</h4>
 <i>%*s1%#9%*s2%</i>
 <h4>Входной файл:</h4>
 <table border="1" cellspacing="0" cellpadding="0">
  <tr><td>Первый</td><td>Красный</td></tr>
  <tr><td>Второй</td><td>Зеленый</td></tr>
  <tr><td>Третий</td><td>Синий</td></tr>
  <tr><td>Четвертый</td><td>Коричневый</td></tr>
 </table>
 Открыть <a href="example_ru.txt" target="_new">example.txt</a>
 <h4>Результат:</h4>
 Открыть <a href="example_ru.htm" target="_new">example.htm</a>
 <h4>Особенности:</h4>
 <ul>
  <li>В программе есть четыре предустановленных типа скриптов: для стандартных таблиц (разделители табуляции)
  на три и четыре столбца, оптимизатор для текстовых файлов (автоматически приписывает в конец нужный символ конца
  строки, так что после последнего идентификатора Вам писать ничего не нужно, и скрипты для бинарных файлов - писать
  так, как написано в руководстве.
 </ul>
</body>
</html>
