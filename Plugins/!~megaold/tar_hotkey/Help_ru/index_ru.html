<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>Описание плагина tar_hotkey</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
</head>
<body>
 <center>
 <h1>Плагин управления горячими клавишами</h1>
 </center>
 <h2>Версия: 1.0 final</h2>
 <h2>Автор: Python &lt;smisoft@rambler.ru&gt; (c) SmiSoft (SA)</h2>
 <h3>Что это такое:</font></h3>
 <p>Некоторые команды выполняются столь часто (например, вызов Winamp, перемотка песен вперед и назад), что для их выполнения недостаточно удобна даже консоль TaR'а...</p>
 <p>Этот плагин позволяет вызывать плагины с использованием любых доступных на вашей клавиатуре сочетаний (до 5 клавиш одновременно).</p>
 <p>Наконец то нашел время, чтобы написать финальную версию.</p>
 <h3>Возможности:</h3>
 <p>Запускает плагин, или программу с параметрами при нажатии определенной заранее комбинации клавиш на клавиатуре</p>
 <h3>Алиасы:</h3>
 <ul>
  <li><b>~SetHotkey</b>
   <ul>
    <li><b>Синтаксис:</b>
     <br><i>~SetHotkey идентификатор список_горячих_клавиш [/run,/tar] команда</i>
    <li><b>Описание:</b>
    <br>Устанавливает или модифицирует указанный горячий ключ из командной строки TaR. 
    <li><b>Параметры:</b>
    <ul>
     <li><i>Идентификатор</i> - произвольная строка, не содержащая пробелов, используется как имя в редакторе горячих ключей (см. ниже) и в функция ~KillHotKey и ~GetHotKey.
     <li><i>Список_горячих_клавиш</i> - несколько (до 5) разделенных пробелами скан-кодов или имен клавиш. Скан коды вводятся в шестнадцатеричном виде с предшествующим символом $. В этой версии поддерживаются следующие имена:
     <ul>
      <li><i>LCtrl,RCtrl</i> - левый и правый Control
      <li><i>LShift,RShift</i> - левый и правый Shift
      <li><i>LAlt,RAlt</i> - левый и правый Alt
      <li><i>LWin,RWin</i> - левый и правый Win
      <li><i>Ctrl,Shift,Win,Alt</i> - соответственно, любой Control, Shift, Alt, Win
      <li><i>Menu</i> - кнопка вызова меню на клавиатуре Microsoft Natural
      <li><i>Esc</i> - клавиша Esc
      <li><i>F1..F12</i> - функциональные клавиши
      <li><i>~,1..9,0,-,=,\</i> - соответствующие клавиши на обычной клавиатуре
      <li><i>любые буквы, [, ], ;, ', /, запятая, точка</i>
      <li><i>Ins,Home,PgUp,Del,End,PgDn</i> - соответственно, клавиши Insert, Home,Page up, Delete, End, Page Down на обычной клавиатуре
      <li><i>UArrow, LArrow,DArrow, RArrow</i> - стрелки на обычной клавиатуре (соответственно, вверх, влево, вниз, вправо)
      <li><i>Gr1..Gr9,Gr0,Gr.,Gr+,Gr-,Gr*,Gr/</i> - соответствующие клавиши на цифровой клавиатуре (она также называется "серой", откуда и приставки Gr)
      <li><i>Vol+,Vol-,VolMute,Prev,Pause,Stop,Next,Media,Calc,MyComp</i> - соответствующие мультимедийные клавиши на клавиатуре Dialog. Скорее всего, если у вас есть мультимедийные клавиши, то они соответствуют этим константам - используйте Редактор.
      <li><i>Halt,Refresh,Search,Favourites,Back,Forward,Home,EMail</i> - дополнительные мультимедийные клавиши на клавиатуре Dialog. Возможно, у вас есть аналогичные клавиши - используйте Редактор.
     </ul>
     Не поддерживаются клавиши: Enter, серый Enter, CapsLock, NumLock, ScrollLock, PrintScreen, Pause. На самом деле, их можно указать через Редактор, но я не рекомендую делать этого в силу специфических функций этих клавиш.
     <br>Скан-коды обычных клавиш для всех клавиатур - постоянны, чего нельзя сказать о скан-кодах мультимедийных клавиш клавиатур разных производителей.
      Поэтому файл конфигурации после смены клавиатуры (или после переноса программы на другой компьютер, с клавиатурой от другого производителя) придется обновить.
     <li><i>/run</i> или <i>/tar</i> - выполнение программы (с параметрами), либо алиаса TaR через стандартный интерфейс
     <li><i>команда</i> - имя программы и параметры через пробел (если используется /run), или произвольная строка для консоли TaR
    </ul>
    <li><b>Примеры:</b>
    <ul>
     <li><i>~sethotkey Word Back /tar Word</i>
     <br>Вызов Word по нажатии клавиши Backward (мультимедийная клавиша, на вашей машине код может быть другим)
     <li><i>~sethotkey Winamp Shift Control Esc /run C:\Programs\Winamp\Winamp.exe</i>
     <br>Вызов Winamp по нажатию сочетания Control-Shift-Esc (если ваш Winamp лежит в другом каталоге, строка будет иной)
    </ul>
    <li><b>Особенности:</b>
    <ul>
     <li>Если указать несколько клавиш, то они должны быть нажаты одновременно, даже если это - не привычные клавиши. Можно создать "секретную" программу, вызываемую, например, одновременным нажатием всех четрыех стрелок!
     <li>(Внимание! Стрелки на цифровой клавиатуре не идентичны обычным стрелкам!!! Это - не глюк, а особенность)
    </ul>
   </ul>
  </li>
  <li>
   <b>~KillHotKey</b>
   <ul>
    <li><b>Синтаксис:</b>
     <br><i>~KillHotKey [идентификатор]</i>
    <li><b>Описание:</b>
     <br>Уничтожает горячий ключ с указанным идентификатором.
    <li><b>Параметры:</b>
     <ul>
      <li><i>Идентификатор</i> - идентификатор удаляемого горячего ключа. Если не указан, выдается запрос на уничтожение всех горячих ключей
     </ul>
    <li><b>Примеры:</b>
     <ul>
      <li><i>~KillHotKey Word</i>
       <br>Уничтожает ключ из первого примера (в описании ~SetHotKey)
      <li><i>~KillHotKey</i>
       <br>Выдается запрос на уничтожение всех горячих ключей и в зависимости от ответа либо стираются все горячие ключи, либо ничего не происходит
     </ul>  
   </ul>
  <li>
   <b>~GetHotKey</b>
   <ul>
    <li><b>Синтаксис:</b>
     <br><i>~GetHotKey [идентификатор]</i>
    <li><b>Описание:</b>
     <br>Выдает информацию о соответствующем горячем ключе.
    <li><b>Параметры:</b>
     <ul>
      <li><i>Идентификатор</i> - идентификатор горячего ключа, о котором требуется запросить информацию. Если нет идентификатора - вызывает редактор.
       <br>В редакторе есть:
       <ul>
        <li>Список горячих ключей
        <li>Поле имени (идентификатор) - туда нужно записать любую строку без пробелов
        <li>Набор галок (Ctrl и т.д.) - это флаги (соответствующая клавиша должна быть нажата)
        <li>Четыре поля ввода клавиш. Эти клавиши должны быть нажаты одновременно. Чтобы ввести скан код, поместите курсор в поле и нажмите нужную клавишу. Чтобы стереть код, нажмите эту клавигу снова.
        <li>Поле ввода типа задания и поле ввода командной строки с кнопкой обзора (которая добавляет имя файла в позицию курсора поля ввода).
        <li>Кнопки "Добавить" - добавляет новый ключ к списку, "Удалить" - удаляет выделенный ключ. Все работает так же, как и в TaR на странице "Редактор конфига" (сделано специально, чтобы пользователям не нужно было бы переучиваться)
       </ul>
       В принципе, любая операция с плагином может быть выполнена через Редактор, дублирующие его функции команды просто для полноты картины...
     </ul>
   </ul>
  </li>
 </ul>
 <center><img src="get_ru.gif"></center>
 <h3>Установка:</h3>
 <p>Собственно, кроме файла tar_hotkey.dll в архиве должен быть еще файл KHook.dll. Этот файл нужно распаковать в каталог, где лежит typeandrun.exe, или C:\Windows\System (если Windows установлен в другой каталог, учтите). Это - особенность примененного в плагине метода. Если KHook.dll отсутствует, плагин не загрузится!</p>
 <p>Еще в архиве есть файл tar_hotkey.ini. Его нужно поместить в папку с tar_hotkey.dll. В этом файле (это обычный .INI) есть раздел [Language], в котором хранятся строковые ресурсы. Если этого раздела нет, то будет использован русский интерфейс.</p>
 <h3>Особенности:</h3>
  <ol>
   <li>Не все сочетания могут быть работоспособны. Например, если прижать "Стрелка влево", "Стрелка вверх", "Стрелка вправо", то кнопка "H" работать не будет (во всяком случае, на моей клавиатуре, проблема существует также в Need For Speed)
   <li>Если при загрузке плагина призошла ошибка, TaR будет считать, что все в порядке и покажет, что плагин загружен (хотя работать он не будет)
   <li>При наличии большого количества горячих ключей работа системы может замедлиться - недостаток глобального хука. Используйте плагин tar_hotkeys вместо tar_hotkey
   <li>Если какая-то программа определяет те же горячие ключи, то выполняется только ключ из плагина. Это означает, что вам придется отказаться от использования других менеджеров горячих ключей. Исключение - стандартные сочетания вроде Win-M, они выполняются одновременно с командой из плагина.
   <li>Некоторые драйвера особым образом обрабатывают клавиши типа Power,Sleep,WakeUp, выполняя команду немедленно и не передавая информацию о нажатии в систему. Поэтому на некоторых машинах установить горячие клавиши с использованием этих клавиш невозможно.
   <li>Кнопка Tab в редакторе работает обычным образом. Определить Tab в горячей клавише нельзя в принципе. Может, обойдетесь?
   <li>При активном редакторе горячие ключи плагина не работают. Это - не баг, а особенность.
   <li>Английская версия описания - не точный перевод, а скорее, пересказ. Поэтому если найдете незначительные отклонения, не обижайтесь.
   <li>Если вы получили сообщение об ошибке установки или снятия хука, лучше перезагрузите компьютер - в таком случае я не могу гарантировать стабильную работу не только плагина, но у всей систему.
   <li>.ini файл в этом пакете не только перевод интерфеса плагина на русский, но и пример объявления горячих клавишe. Некоторые горячие клавиши работают только при наличии моего плагина tar_media.
   <li>Случается, что нажатия на некоторые клавиши не достигают моего плагина. Обычно это происходит при активном обращении к внешним устройствам, например ТВ-тюнеру, внешнему модему или принтеру (LPT, но не USB). Если вам покажется, что горячие клавиши работают странно или не работают вообще, нажмите Ctrl-Alt-Shift-F12. Это вернет плагин в исходное состояние. Эту комбинацию нельзя сменить и ее лучше не назначать другим задачам.
  </ol> 
 <b><font size=+1 color=blue>История:</font></b>
 <br><font color=green>[+]</font>&nbsp;Новая фича
 <br><font color=blue>[*]</font>&nbsp;Пофиксен баг
 <br><font color=red>[-]</font>&nbsp;Убрана фича
 
 <p><font size=+1 color=blue>Версия 1.0 alpha - 21.05.05</font>
 <br><font color=green>[+]</font>&nbsp;Первая, нестабильная, неполнофункциональная версия

 <p><font size=+1 color=blue>Версия 1.0 beta - 23.05.05</font>
 <br><font color=green>[+]</font>&nbsp;Исправлена ошибка, возникающая при запуске программы без использования командной строки
 <br><font color=green>[+]</font>&nbsp;Похожий на TaR интерфейс
 <br><font color=green>[+]</font>&nbsp;Английский интерфейс и справка(см. раздел "Установка")
 <br><font color=blue>[*]</font>&nbsp;Улучшен алгоритм перехвата клавиатуры (теперь работает во всех Windows, как 9x, так и NT/2000/XP) 
 <br><font color=blue>[*]</font>&nbsp;Перекомпилировано без использования vcl (и сжато в UPX)

 <p><font size=+1 color=blue>Версия 1.0 final - 16.06.05</font>
 <br><font color=green>[+]</font>&nbsp;Добавлено много новых констант для клавиш
 <br><font color=green>[+]</font>&nbsp;Новая справка в формате CHM
 <br><font color=green>[+]</font>&nbsp;В редакторе новая функция: Ctrl-Up передвигает выделенный элемент вверх, Ctrl-Down - вниз, Ctrl-PageUp - в начало списка, Ctrl-PageDown - в конец списка.
 <br><font color=blue>[*]</font>&nbsp;Теперь сочетания Win-... обрабатываются корректно и в текстовых полях не появляются лишние символы.
 <br><font color=blue>[*]</font>&nbsp;Новый, более быстрый алгоритм перехвата. К сожалению, иногда он дает сбой, см. пункт 11 раздела Особенности
 
</body>
</html>
